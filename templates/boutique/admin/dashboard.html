{% extends 'boutique/base.html' %}

{% block content %}
<div class="container">
    <h2 class="section-title">Admin Dashboard</h2>
    
    <div class="dashboard-cards">
        <div class="dashboard-card">
            <h3>Total Products</h3>
            <div class="number">{{ total_products }}</div>
        </div>
        <div class="dashboard-card">
            <h3>Total Orders</h3>
            <div class="number">{{ total_orders }}</div>
        </div>
        <div class="dashboard-card">
            <h3>Total Customers</h3>
            <div class="number">{{ total_customers }}</div>
        </div>
        <div class="dashboard-card">
            <h3>Revenue</h3>
            <div class="number">PKR{{ total_revenue|floatformat:0 }}</div>
        </div>
    </div>
    
    <div class="admin-actions" style="display: flex; gap: 15px; margin: 30px 0;">
        <a href="{% url 'admin_add_product' %}" class="btn">Add New Product</a>
        <a href="{% url 'admin_send_newsletter' %}" class="btn">Send Newsletter</a>
        <a href="{% url 'admin_view_categories' %}" class="btn">View Categories</a>
        <a href="{% url 'admin_view_customers' %}" class="btn">View Customers</a>
    </div>
    
    <div class="recent-orders" style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
    <div class="admin-products" style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); margin-bottom: 30px;">
        <h2 style="border-bottom: 3px solid #8B5C2A; display: inline-block; padding-bottom: 6px;">Manage Products</h2>
        {% if products %}
        <table style="width: 100%; border-collapse: collapse; margin-top: 20px;">
            <thead>
                <tr style="border-bottom: 2px solid #eee;">
                    <th style="padding: 10px; text-align: left;">ID</th>
                    <th style="padding: 10px; text-align: left;">Name</th>
                    <th style="padding: 10px; text-align: left;">Category</th>
                    <th style="padding: 10px; text-align: left;">Price</th>
                    <th style="padding: 10px; text-align: left;">Stock</th>
                    <th style="padding: 10px; text-align: left;">Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for product in products %}
                <tr style="border-bottom: 1px solid #eee;">
                    <td style="padding: 10px;">{{ product.id }}</td>
                    <td style="padding: 10px;">{{ product.name }}</td>
                    <td style="padding: 10px;">{{ product.category.name }}</td>
                    <td style="padding: 10px;">PKR{{ product.price }}</td>
                    <td style="padding: 10px;">{{ product.stock }}</td>
                    <td style="padding: 10px;">
                        <a href="{% url 'admin_edit_product' product.id %}" class="btn" style="background: #2c3e50; color: #fdfcfc; padding: 5px 10px;">Edit</a>
                        <a href="{% url 'admin_delete_product' product.id %}" class="btn" style="background: #c19a6b; color: #fff; padding: 5px 10px;">Delete</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <p>No products found.</p>
        {% endif %}
    </div>
        <h2 style="border-bottom: 3px solid #8B5C2A; display: inline-block; padding-bottom: 6px;">Recent Orders</h2>
        {% if recent_orders %}
        <table style="width: 100%; border-collapse: collapse; margin-top: 20px;">
            <thead>
                <tr style="border-bottom: 2px solid #eee;">
                    <th style="padding: 10px; text-align: left;">Order ID</th>
                    <th style="padding: 10px; text-align: left;">Customer</th>
                    <th style="padding: 10px; text-align: left;">Date</th>
                    <th style="padding: 10px; text-align: left;">Amount</th>
                    <th style="padding: 10px; text-align: left;">Status</th>
                </tr>
            </thead>
            <tbody>
                {% for order in recent_orders %}
                <tr style="border-bottom: 1px solid #eee;">
                    <td style="padding: 10px;">#{{ order.id }}</td>
                    <td style="padding: 10px;">{{ order.customer.user.username }}</td>
                    <td style="padding: 10px;">{{ order.order_date|date:"M d, Y" }}</td>
                    <td style="padding: 10px;">PKR{{ order.total_amount }}</td>
                    <td style="padding: 10px;">
                        {% if order.status == 'delivered' %}
                        <span style="padding: 5px 10px; border-radius: 20px; background: #d4edda;">
                            {{ order.status|title }}
                        </span>
                        {% elif order.status == 'shipped' %}
                        <span style="padding: 5px 10px; border-radius: 20px; background: #cce5ff;">
                            {{ order.status|title }}
                        </span>
                        {% elif order.status == 'processing' %}
                        <span style="padding: 5px 10px; border-radius: 20px; background: #fff3cd;">
                            {{ order.status|title }}
                        </span>
                        {% else %}
                        <span style="padding: 5px 10px; border-radius: 20px; background: #f8d7da;">
                            {{ order.status|title }}
                        </span>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <p>No orders yet.</p>
        {% endif %}
    </div>
</div>
{% endblock %}

